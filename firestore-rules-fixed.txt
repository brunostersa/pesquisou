# ğŸ”’ Regras de SeguranÃ§a do Firestore - CORRIGIDAS

# âœ… Estas regras resolvem o problema de criaÃ§Ã£o de Ã¡reas e feedbacks

rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // UsuÃ¡rios: usuÃ¡rios podem ler/escrever apenas seus prÃ³prios dados
    match /users/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
    
    // Ãreas: usuÃ¡rios podem ler/escrever apenas suas prÃ³prias Ã¡reas
    match /areas/{areaId} {
      allow read, write: if request.auth != null && request.auth.uid == resource.data.userId;
      allow create: if request.auth != null && request.auth.uid == request.resource.data.userId;
    }
    
    // Feedbacks: qualquer pessoa pode escrever, usuÃ¡rios podem ler feedbacks de suas Ã¡reas
    match /feedbacks/{feedbackId} {
      allow write: if true;
      allow read: if request.auth != null && 
        exists(/databases/$(database)/documents/areas/$(resource.data.areaId)) &&
        get(/databases/$(database)/documents/areas/$(resource.data.areaId)).data.userId == request.auth.uid;
    }
  }
}

# ğŸ“‹ Como aplicar:
# 1. Acesse https://console.firebase.google.com/
# 2. Selecione seu projeto "pesquisou-ee03b"
# 3. VÃ¡ em "Firestore Database" no menu lateral
# 4. Clique na aba "Regras"
# 5. Substitua todo o conteÃºdo pelas regras acima
# 6. Clique em "Publicar"
# 7. Aguarde alguns segundos para as regras serem aplicadas

# âœ… Estas regras resolvem:
# - Permite criaÃ§Ã£o de usuÃ¡rios
# - Permite criaÃ§Ã£o de Ã¡reas (com allow create)
# - Permite escrita pÃºblica em feedbacks
# - MantÃ©m seguranÃ§a para leitura de feedbacks

# ğŸ§ª Para testar:
# 1. Aplique as regras acima
# 2. Acesse http://localhost:3000/test
# 3. Teste escrita e leitura
# 4. Teste o sistema completo 